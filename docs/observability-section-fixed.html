<!-- Built-in Observability Section - VERSÃO CORRIGIDA -->
<section id="observability" class="container relative mx-auto px-6 py-16 md:py-24 border-t border-[#2E3033] scroll-reveal">
    <h2 class="text-3xl md:text-4xl font-bold text-[#E6E8EB] mb-8 lg:mb-12">Built-in observability</h2>
    
    <div id="observability-tabs-container" class="flex flex-col md:flex-row gap-4 h-auto md:h-[500px]">
        
        <!-- Tab 1: Realtime Logs (Inicialmente ativa) -->
        <div class="observability-tab active flex-[2] transition-all duration-500" 
             data-tab-id="realtime-logs"
             role="tab" 
             aria-selected="true"
             tabindex="0">
            <div class="dx-card rounded-xl h-full p-6 flex flex-col justify-between cursor-pointer hover:border-[#4A4F55]">
                <div>
                    <h3 class="tab-title font-mono text-sm uppercase text-white transition-colors duration-300">Realtime logs</h3>
                    <p class="tab-description text-sm text-[#A0A3A8] mt-2 max-h-20 overflow-hidden transition-all duration-500">
                        Stream logs to the dashboard in realtime. Logs are populated with rich metadata to help debugging.
                    </p>
                </div>
                <div class="tab-panel mt-4 h-[300px] overflow-hidden relative transition-all duration-500">
                    <div class="absolute inset-x-0 bottom-0 h-24 bg-gradient-to-t from-[#1C1F26] to-transparent z-10"></div>
                    <ul class="font-mono text-xs">
                        <li class="flex gap-4 items-center py-2 border-b border-[#2E3033]">
                            <span class="text-[#A0A3A8]">17 Sep 14:21:06</span>
                            <span class="inline-flex items-center bg-gray-700 text-gray-300 border border-gray-600 px-2 py-0.5 text-xs rounded">200</span>
                            <span class="w-10">POST</span>
                            <span>4c27...c700</span>
                        </li>
                        <li class="flex gap-4 items-center py-2 border-b border-[#2E3033]">
                            <span class="text-[#A0A3A8]">17 Sep 13:47:46</span>
                            <span class="inline-flex items-center bg-gray-700 text-gray-300 border border-gray-600 px-2 py-0.5 text-xs rounded">200</span>
                            <span class="w-10">GET</span>
                            <span>d3a2...c6d3</span>
                        </li>
                        <li class="flex gap-4 items-center py-2 border-b border-[#2E3033]">
                            <span class="text-[#A0A3A8]">17 Sep 13:31:06</span>
                            <span class="inline-flex items-center bg-red-800 text-red-300 border border-red-700 px-2 py-0.5 text-xs rounded">500</span>
                            <span class="w-10">POST</span>
                            <span>2e88...a856</span>
                        </li>
                        <li class="flex gap-4 items-center py-2 border-b border-[#2E3033]">
                            <span class="text-[#A0A3A8]">17 Sep 13:14:26</span>
                            <span class="inline-flex items-center bg-gray-700 text-gray-300 border border-gray-600 px-2 py-0.5 text-xs rounded">200</span>
                            <span class="w-10">GET</span>
                            <span>85a4...0e28</span>
                        </li>
                        <li class="flex gap-4 items-center py-2 border-b border-[#2E3033]">
                            <span class="text-[#A0A3A8]">17 Sep 12:58:12</span>
                            <span class="inline-flex items-center bg-gray-700 text-gray-300 border border-gray-600 px-2 py-0.5 text-xs rounded">201</span>
                            <span class="w-10">POST</span>
                            <span>7fa3...1b42</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Tab 2: Query Logs -->
        <div class="observability-tab flex-1 transition-all duration-500" 
             data-tab-id="query-logs"
             role="tab" 
             aria-selected="false"
             tabindex="0">
            <div class="dx-card rounded-xl h-full p-6 flex flex-col justify-between cursor-pointer hover:border-[#4A4F55]">
                <div>
                    <h3 class="tab-title font-mono text-sm uppercase text-[#A0A3A8] transition-colors duration-300">Query Logs</h3>
                    <p class="tab-description text-sm text-[#A0A3A8] mt-2 max-h-0 overflow-hidden transition-all duration-500">
                        Get deeper insights by writing SQL queries on function logs.
                    </p>
                </div>
                <div class="tab-panel mt-4 h-[300px] overflow-hidden relative opacity-0 transition-all duration-500">
                    <div class="absolute inset-x-0 bottom-0 h-24 bg-gradient-to-t from-[#1C1F26] to-transparent z-10"></div>
                    <div class="bg-[#0D1116] rounded-lg p-4 h-full overflow-auto">
                        <pre class="font-mono text-xs text-[#A0A3A8]"><code><span class="text-blue-400">SELECT</span> 
  status_code,
  <span class="text-green-400">COUNT</span>(*) <span class="text-blue-400">AS</span> count,
  <span class="text-green-400">AVG</span>(execution_time) <span class="text-blue-400">AS</span> avg_time
<span class="text-blue-400">FROM</span> function_logs
<span class="text-blue-400">WHERE</span> created_at > <span class="text-green-400">NOW</span>() - <span class="text-yellow-400">INTERVAL</span> <span class="text-red-400">'1 hour'</span>
<span class="text-blue-400">GROUP BY</span> status_code
<span class="text-blue-400">ORDER BY</span> count <span class="text-blue-400">DESC</span>;</code></pre>
                        <div class="mt-4 border-t border-[#2E3033] pt-4">
                            <p class="text-xs text-[#A0A3A8] mb-2">Results:</p>
                            <table class="w-full text-xs">
                                <thead>
                                    <tr class="border-b border-[#2E3033]">
                                        <th class="text-left py-1 text-[#A0A3A8]">status_code</th>
                                        <th class="text-left py-1 text-[#A0A3A8]">count</th>
                                        <th class="text-left py-1 text-[#A0A3A8]">avg_time</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-[#2E3033]">
                                        <td class="py-1 text-green-400">200</td>
                                        <td class="py-1">847</td>
                                        <td class="py-1">142ms</td>
                                    </tr>
                                    <tr class="border-b border-[#2E3033]">
                                        <td class="py-1 text-yellow-400">201</td>
                                        <td class="py-1">231</td>
                                        <td class="py-1">284ms</td>
                                    </tr>
                                    <tr class="border-b border-[#2E3033]">
                                        <td class="py-1 text-red-400">500</td>
                                        <td class="py-1">12</td>
                                        <td class="py-1">892ms</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 3: Metrics -->
        <div class="observability-tab flex-1 transition-all duration-500" 
             data-tab-id="metrics"
             role="tab" 
             aria-selected="false"
             tabindex="0">
            <div class="dx-card rounded-xl h-full p-6 flex flex-col justify-between cursor-pointer hover:border-[#4A4F55]">
                <div>
                    <h3 class="tab-title font-mono text-sm uppercase text-[#A0A3A8] transition-colors duration-300">Metrics</h3>
                    <p class="tab-description text-sm text-[#A0A3A8] mt-2 max-h-0 overflow-hidden transition-all duration-500">
                        Dashboards show the health of your functions at all times.
                    </p>
                </div>
                <div class="tab-panel mt-4 h-[300px] relative opacity-0 transition-all duration-500">
                    <div class="flex flex-col h-full">
                        <div class="mb-4">
                            <p class="text-xs text-[#A0A3A8] mb-1">Invocations (last 24h)</p>
                            <p class="text-2xl font-bold text-white">12,847</p>
                            <p class="text-xs text-green-400">↑ 23% from yesterday</p>
                        </div>
                        <div class="flex-1 relative">
                            <svg width="100%" height="100%" viewBox="0 0 200 120" class="absolute bottom-0 left-0">
                                <defs>
                                    <linearGradient id="chartGradient" x1="0" y1="0" x2="0" y2="1">
                                        <stop offset="5%" stop-color="#22c55e" stop-opacity="0.4"/>
                                        <stop offset="95%" stop-color="#22c55e" stop-opacity="0"/>
                                    </linearGradient>
                                </defs>
                                <!-- Grid lines -->
                                <g stroke="#2E3033" stroke-width="0.5">
                                    <line x1="0" y1="30" x2="200" y2="30" />
                                    <line x1="0" y1="60" x2="200" y2="60" />
                                    <line x1="0" y1="90" x2="200" y2="90" />
                                </g>
                                <!-- Chart area -->
                                <path d="M 0 90 C 20 80, 40 85, 60 70 S 100 40, 120 50 S 160 85, 180 60 L 200 65 V 120 H 0 Z" 
                                      fill="url(#chartGradient)" />
                                <!-- Chart line -->
                                <path d="M 0 90 C 20 80, 40 85, 60 70 S 100 40, 120 50 S 160 85, 180 60 L 200 65" 
                                      stroke="#22c55e" stroke-width="2" fill="none" />
                                <!-- Data points -->
                                <g fill="#22c55e">
                                    <circle cx="0" cy="90" r="3" />
                                    <circle cx="60" cy="70" r="3" />
                                    <circle cx="120" cy="50" r="3" />
                                    <circle cx="180" cy="60" r="3" />
                                    <circle cx="200" cy="65" r="3" />
                                </g>
                            </svg>
                        </div>
                        <div class="grid grid-cols-3 gap-4 mt-4 pt-4 border-t border-[#2E3033]">
                            <div>
                                <p class="text-xs text-[#A0A3A8]">Avg Duration</p>
                                <p class="text-sm font-semibold text-white">142ms</p>
                            </div>
                            <div>
                                <p class="text-xs text-[#A0A3A8]">Success Rate</p>
                                <p class="text-sm font-semibold text-green-400">99.2%</p>
                            </div>
                            <div>
                                <p class="text-xs text-[#A0A3A8]">P95 Latency</p>
                                <p class="text-sm font-semibold text-white">384ms</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>

<style>
/* Estilos específicos para as tabs de observability */
.observability-tab {
    position: relative;
}

.observability-tab.active {
    flex: 2;
}

.observability-tab:not(.active) {
    flex: 1;
}

.observability-tab.active .tab-title {
    color: #ffffff;
}

.observability-tab:not(.active) .tab-title {
    color: #A0A3A8;
}

.observability-tab.active .tab-description {
    max-height: 5rem;
    opacity: 1;
}

.observability-tab:not(.active) .tab-description {
    max-height: 0;
    opacity: 0;
}

.observability-tab.active .tab-panel {
    opacity: 1;
    visibility: visible;
}

.observability-tab:not(.active) .tab-panel {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

/* Animação suave para mobile */
@media (max-width: 768px) {
    .observability-tab {
        flex: 1 !important;
    }
    
    .observability-tab:not(.active) .tab-panel {
        display: none;
    }
    
    .observability-tab.active .tab-panel {
        display: block;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const observabilityContainer = document.getElementById('observability-tabs-container');
    
    if (observabilityContainer) {
        const tabs = observabilityContainer.querySelectorAll('.observability-tab');
        
        // Função para ativar uma tab específica
        function activateTab(targetTab) {
            tabs.forEach(tab => {
                if (tab === targetTab) {
                    // Ativa a tab clicada
                    tab.classList.add('active');
                    tab.setAttribute('aria-selected', 'true');
                } else {
                    // Desativa as outras tabs
                    tab.classList.remove('active');
                    tab.setAttribute('aria-selected', 'false');
                }
            });
        }
        
        // Adiciona event listeners para cada tab
        tabs.forEach(tab => {
            // Adiciona o clique no card inteiro
            const card = tab.querySelector('.dx-card');
            
            if (card) {
                card.addEventListener('click', function(e) {
                    e.preventDefault();
                    activateTab(tab);
                });
                
                // Suporte para navegação via teclado
                tab.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        activateTab(tab);
                    }
                });
            }
        });
        
        // Ativa a primeira tab por padrão
        if (tabs.length > 0) {
            activateTab(tabs[0]);
        }
    }
});
</script>